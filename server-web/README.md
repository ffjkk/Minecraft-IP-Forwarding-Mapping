# 内网穿透代理服务器 - 可视化管理界面

这是一个功能强大的内网穿透代理服务器，现在配备了完整的Web可视化管理界面！

## ✨ 主要功能

### 🖥️ Web可视化界面
- **实时监控面板**：查看连接状态、数据传输量、服务器运行时间
- **连接管理**：实时显示活跃连接、等待队列、空闲连接
- **图表统计**：连接数量趋势图表，直观展示服务状态
- **实时日志**：彩色分级日志显示，支持清空和自动滚动
- **响应式设计**：支持桌面和移动设备访问

### 🚀 代理服务功能
- **多用户并发**：支持多个外部用户同时连接
- **连接池管理**：智能的连接匹配和资源管理
- **自动超时处理**：防止僵尸连接占用资源
- **双向数据转发**：完整的网络数据透传
- **优雅关闭**：程序终止时正确清理所有资源

## 📦 安装和使用

### 1. 安装依赖
```bash
npm install
```

### 2. 启动方式

#### 🌐 Web可视化界面模式（推荐）
```bash
npm run web
# 或者
npm start
```
访问: http://localhost:3000

#### 🔧 命令行模式
**启动服务器:**
```bash
npm run server
```

**启动客户端:**
```bash
npm run client
```

## 🎯 使用方法

### Web界面使用
1. 启动Web服务器: `npm run web`
2. 在浏览器中打开: http://localhost:3000
3. 在内网机器上启动客户端: `npm run client`
4. 外部用户连接到服务器的25565端口

### 传统命令行使用
1. 在公网服务器上启动代理服务器: `npm run server`
2. 在内网机器上启动客户端: `npm run client`
3. 外部用户连接到公网服务器的25565端口

## 🔧 配置说明

### 端口配置
- **25565**: 外部用户连接端口（MC服务器默认端口）
- **9000**: 内网客户端连接端口
- **3000**: Web管理界面端口

### 文件说明
- `web-server.js`: Web可视化界面服务器（集成代理功能）
- `server.js`: 原始命令行代理服务器
- `client.js`: 内网客户端
- `public/index.html`: Web管理界面页面

## 📊 Web界面功能详解

### 实时监控
- **总连接数**: 自服务器启动以来的总连接数
- **活跃连接**: 当前正在传输数据的连接数
- **等待队列**: 等待内网连接处理的外部连接数
- **空闲连接**: 空闲的内网连接池数量

### 连接管理
- **活跃连接列表**: 显示每个连接的详细信息
  - 连接ID
  - 外部IP ↔ 内网IP
  - 数据传输量
  - 连接持续时间

### 实时日志
- **分级日志**: SUCCESS、INFO、WARNING、ERROR
- **彩色显示**: 不同级别使用不同颜色
- **自动滚动**: 新日志自动滚动到底部
- **日志清空**: 支持手动清空日志

### 统计图表
- **连接趋势图**: 实时显示活跃连接数变化
- **数据传输统计**: 总数据传输量显示
- **服务器运行时间**: 实时更新运行时长

## 🛠️ 技术栈

### 后端
- **Node.js**: 运行环境
- **Express**: Web框架
- **Socket.IO**: 实时通信
- **Net**: TCP网络模块

### 前端
- **Bootstrap 5**: UI框架
- **Chart.js**: 图表库
- **Bootstrap Icons**: 图标库
- **WebSocket**: 实时数据更新

## 🚀 高级功能

### 实时更新
所有数据都通过WebSocket实时更新，无需刷新页面即可看到最新状态。

### 响应式设计
界面完全响应式，支持各种屏幕尺寸，手机、平板、电脑都能完美显示。

### 数据持久化
连接统计和日志信息在内存中维护，重启后会重新开始计算。

## 🔒 注意事项

1. **网络安全**: 请确保Web管理界面只在可信网络中访问
2. **性能监控**: 在高并发环境下请注意监控服务器性能
3. **防火墙设置**: 确保所需端口（25565、9000、3000）在防火墙中开放

## 📞 支持

如果您在使用过程中遇到问题，请检查：
1. 所有依赖是否正确安装
2. 端口是否被占用
3. 防火墙设置是否正确
4. MC服务器是否关闭了正版验证

---

现在您可以通过美观的Web界面轻松管理和监控您的内网穿透代理服务器！🎉
